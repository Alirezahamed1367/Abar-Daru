# راهنمای نصب سرویس ویندوز

## پیش‌نیازها

1. **نصب Python**: مطمئن شوید Python نصب شده و در PATH سیستم اضافه شده است
2. **دانلود NSSM**: ابزار مدیریت سرویس ویندوز

## مراحل نصب

### گام 1: دانلود NSSM

1. به آدرس https://nssm.cc/download بروید
2. نسخه 64-bit را دانلود کنید (اگر ویندوز شما 64-bit است)
3. فایل ZIP را از حالت فشرده خارج کنید
4. فایل `nssm.exe` را از پوشه `win64` کپی کنید
5. فایل را در پوشه اصلی پروژه قرار دهید: `D:\Hamed\Project\Anbar-Daru\nssm.exe`

### گام 2: نصب سرویس

1. روی فایل `install_service.bat` کلیک راست کنید
2. گزینه **"Run as administrator"** را انتخاب کنید
3. منتظر بمانید تا پیام موفقیت نمایش داده شود
4. سرویس نصب شده و به صورت خودکار راه‌اندازی می‌شود

### گام 3: بررسی وضعیت سرویس

#### از طریق Services Manager:
1. کلیدهای `Win + R` را فشار دهید
2. `services.msc` را تایپ کنید و Enter بزنید
3. سرویس "Pharmacy Warehouse Server" را پیدا کنید
4. مطمئن شوید که Status آن "Running" است

#### از طریق مرورگر:
1. مرورگر را باز کنید
2. به آدرس http://localhost:8000 بروید
3. باید صفحه برنامه نمایش داده شود

## مدیریت سرویس

### شروع سرویس:
```cmd
nssm start PharmacyWarehouse
```

### توقف سرویس:
```cmd
nssm stop PharmacyWarehouse
```

### راه‌اندازی مجدد سرویس:
```cmd
nssm restart PharmacyWarehouse
```

### حذف سرویس:
روی فایل `uninstall_service.bat` کلیک راست کرده و **"Run as administrator"** را انتخاب کنید

یا از دستور زیر استفاده کنید:
```cmd
nssm remove PharmacyWarehouse confirm
```

## لاگ‌ها

لاگ‌های سرویس در پوشه زیر ذخیره می‌شوند:
- خروجی استاندارد: `D:\Hamed\Project\Anbar-Daru\logs\service_output.log`
- خطاها: `D:\Hamed\Project\Anbar-Daru\logs\service_error.log`

## عیب‌یابی

### سرویس شروع نمی‌شود:
1. لاگ‌های موجود در پوشه `logs` را بررسی کنید
2. مطمئن شوید Python در PATH سیستم موجود است
3. بررسی کنید که پورت 8000 توسط برنامه دیگری استفاده نمی‌شود

### خطای "Access Denied":
- اطمینان حاصل کنید که فایل‌های bat را با دسترسی Administrator اجرا می‌کنید

### خطای "Python not found":
1. کنترل پنل > System > Advanced system settings > Environment Variables
2. در قسمت System variables، متغیر Path را پیدا کنید
3. مسیر نصب Python را اضافه کنید (مثلاً `C:\Python314`)

## راه‌اندازی خودکار

پس از نصب، سرویس به صورت خودکار:
- هنگام روشن شدن ویندوز اجرا می‌شود
- در صورت کرش شدن، دوباره راه‌اندازی می‌شود
- در پس‌زمینه اجرا می‌شود (بدون باز شدن پنجره)

## دسترسی از شبکه

برای دسترسی از کامپیوترهای دیگر در شبکه:
1. فایروال ویندوز را پیکربندی کنید تا پورت 8000 را باز کند
2. از آدرس IP سرور استفاده کنید: `http://178.63.160.203:8000`
